ğŸ’» ê°œë°œ í™˜ê²½ ì†Œê°œ
- ì–´ë–¤ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì‚¬ìš©í•˜ì˜€ë‚˜? MySQL
```
MySQLì€ ì´ë¯¸ ì—¬ëŸ¬ ë¶„ì•¼ì— ì ìš©ë˜ì–´ ì œí’ˆì˜ ì•ˆì •ì„±ì´ ê²€ì¦ëœ ê°€ì¥ ì¸ê¸° ìˆëŠ” ì˜¤í”ˆ ì†ŒìŠ¤ ê´€ê³„í˜• ë°ì´í„°ë² ì´ìŠ¤ ì‹œìŠ¤í…œìœ¼ë¡œ,
ANSI/ISOí‘œì¤€ì—ì„œ ì •ì˜í•œ ë°ì´í„°ë² ì´ìŠ¤ ì ‘ì†ì„ ìœ„í•œ ê°€ì¥ ì¼ë°˜ì ì¸ í‘œì¤€ ì–¸ì–´ì¸ SQLì„ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì— ë°°ìš°ê³  ì‚¬ìš©í•˜ê¸° ì‰¬ìš°ë©°,
SQL í‘œì¤€í•¨ìˆ˜ì˜ ê²½ìš° íƒ€ DBì™€ ë™ì¼í•˜ê²Œ ì‚¬ìš©ì´ ê°€ëŠ¥í•˜ë‹¤. ë˜í•œ, LAMP(Linux, Apache, MySQL,PHP/Perl)ëŠ” ë¬¼ë¡  SAMP(Solaris, Apache, MySQL, PHP/Perl),
WAMP (Windows, Apache, MySQL,PHP/Perl) ë“± ì‚¬ìš©ìì˜ í™˜ê²½ì— ë§ëŠ” ëŒ€ë¶€ë¶„ì˜ í”Œë«í¼ì„ ì§€ì›í•¨ì€ ë¬¼ë¡  MySQL ë°ì´í„°ë² ì´ìŠ¤ ì†Œí”„íŠ¸ì›¨ì–´ëŠ”
ë‹¤ì¤‘-ì“°ë ˆë“œSQLì„œë²„ë¡œ í´ë¼ì´ì–¸íŠ¸/ì„œë²„ ë˜ëŠ” ì„ë² ë””ë“œ ì‹œìŠ¤í…œì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.
ìŠ¤í† ë¦¬ì§€ ì—”ì§„ì€ ë™ì ìœ¼ë¡œ ë³€ê²½í•˜ì—¬ ê´€ë¦¬í•  ìˆ˜ ìˆìœ¼ë©° ì‚¬ìš©í•˜ëŠ” ì–´í”Œë¦¬ì¼€ì´ì…˜ì˜ ìµœì ì˜ ì„±ëŠ¥ì„ ë‚˜íƒ€ë‚¼ ìˆ˜ ìˆë„ë¡ ë„ì™€ì¤€ë‹¤.
```

- ì–´ë–¤ ì›¹ ì„œë²„ë¥¼ ì‚¬ìš©í•˜ì˜€ë‚˜? ìœˆë„ìš° + Apache Web Server
```
ìš´ì˜ì²´ì œ ì‹œì¥ì—ì„œ ìœˆë„ìš°ì˜ ì ìœ ìœ¨ì€ 91.07%ì— ì´ë¥¼ ì •ë„ë¡œ ë„ë¦¬ ì‚¬ìš©ë˜ê³  ìˆê³ , ëŒ€ë¶€ë¶„ ìœˆë„ìš° ê¸°ë°˜ì—ì„œ í™ˆí˜ì´ì§€ë¥¼ ì—´ëŒí•˜ê¸° ë•Œë¬¸ì—
ìœˆë„ìš° ë‚´ì¥í°íŠ¸ì— ì˜ì¡´í•˜ëŠ” ì›¹í˜ì´ì§€ë“¤ì˜ í…ìŠ¤íŠ¸ ì„œì‹ì„ ë³´ê¸° ìœ„í•´ ìœˆë„ìš°ì— apmì„ ì„¤ì¹˜í•˜ì—¬ ì‚¬ìš©í•˜ì˜€ë‹¤.
```

ğŸ˜®â—ï¸ ë°œê²¬í•œ ì •ë³´ ì†Œê°œ
- json_extract(): json ë°ì´í„°ë¥¼ stringìœ¼ë¡œ ë°˜í™˜, $ëŠ” doc.ì˜ rootë¥¼ ì˜ë¯¸í•˜ë©° ê¹Šì´ë¥¼ í‘œí˜„í•˜ì—¬ ì›í•˜ëŠ” ë°ì´í„°ë¥¼ ì¶”ì¶œí•  ìˆ˜ ìˆë‹¤.
- json_unquote(): stringìœ¼ë¡œ ë°˜í™˜ëœ ë°ì´í„°ì˜ ""ë¥¼ ì œê±°í•˜ì—¬ ë°˜í™˜
- json_set(): json ë°ì´í„° ë‚´ìš© set

- ì „ ì„¸ê³„ì˜ ë‚˜ë¼ ì •ë³´ ì¡°íšŒí•˜ê¸°
```
// $filtered_idë¡œ ë°›ì•„ì˜¨ ê¸€ìë¡œ ì‹œì‘í•˜ëŠ” ë‚˜ë¼ë“¤ ì¶œë ¥
// ë‚˜ë¼ ì´ë¦„, ìˆ˜ë„, GNP, ìˆ˜ì¥, ì •ë¶€ í˜•íƒœ, ì¸êµ¬ ìˆ˜, ê¸°ëŒ€ ìˆ˜ëª…, ì¸êµ¬ ë°€ë„ì™€ ê°™ì€ ê¸°ë³¸ì ì¸ ì •ë³´ ì¶œë ¥

// ì‚¬ìš©ìê°€ ì†Œë¬¸ìë¡œ ê²€ìƒ‰í•˜ì—¬ë„ ì œëŒ€ë¡œ ì¶œë ¥í•  ìˆ˜ ìˆê²Œ ucfirst()ë¥¼ ì´ìš©í•´ ëŒ€ë¬¸ìë¡œ ë³€í™˜í•˜ì—¬ ì €ì¥
$filtered_id = ucfirst(mysqli_real_escape_string($link, $_POST['country']));
$query = "SELECT country.Name as Country, city.Name as Capital, json_unquote(json_extract(doc,'$.GNP')) as GNP,
                 json_unquote(json_extract(doc,'$.government.HeadOfState')) as Head,
                 json_unquote(json_extract(doc,'$.government.GovernmentForm')) as GovernmentForm,
                 json_unquote(json_extract(doc,'$.demographics.Population')) as Population,
                 json_unquote(json_extract(doc,'$.demographics.LifeExpectancy')) as LifeExpectancy,
                 json_unquote(json_extract(doc,'$.demographics.Population'))/json_unquote(json_extract(doc,'$.geography.SurfaceArea')) as Population_Density
          FROM country join city on country.Capital = city.ID
          join countryinfo on country.name = json_unquote(json_extract(doc,'$.Name'))
          WHERE LEFT(SUBSTRING_INDEX(replace(country.Name,' ',''), ' ', -1), 1) = '{$filtered_id}' limit 5 ";
```

- íŠ¹ì • ë‚˜ë¼ë¥¼ ê²€ìƒ‰í•˜ì—¬ ì •ë³´ ì¡°íšŒí•˜ê¸°
```
// ì‚¬ìš©ìê°€ ì†Œë¬¸ìë¡œ ê²€ìƒ‰í•˜ì—¬ë„ ì œëŒ€ë¡œ ì¶œë ¥í•  ìˆ˜ ìˆê²Œ ucfirst()ë¥¼ ì´ìš©í•´ ëŒ€ë¬¸ìë¡œ ë³€í™˜í•˜ì—¬ ì €ì¥
$filtered_id = ucfirst(mysqli_real_escape_string($link, $_POST['country']));

$query = "SELECT country.Name as Country, city.Name as Capital, json_unquote(json_extract(doc,'$.GNP')) as GNP,
          json_unquote(json_extract(doc,'$.government.HeadOfState')) as Head,
          json_unquote(json_extract(doc,'$.government.GovernmentForm')) as GovernmentForm,
          json_unquote(json_extract(doc,'$.demographics.Population')) as Population,
          json_unquote(json_extract(doc,'$.demographics.LifeExpectancy')) as LifeExpectancy,
          json_unquote(json_extract(doc,'$.demographics.Population'))/json_unquote(json_extract(doc,'$.geography.SurfaceArea')) as Population_Density
          FROM country join city on country.Capital = city.ID
          join countryinfo on country.name = json_unquote(json_extract(doc,'$.Name'))
          // ì…ë ¥ë°›ì€ ë‚˜ë¼
          WHERE country.Name = '{$filtered_id}'";
```

- ëŒ€ë¥™ë³„ ë‚˜ë¼ ì¡°íšŒ
```
// ì…€ë ‰íŠ¸ ë°•ìŠ¤í˜•íƒœì—ì„œ ì›í•˜ëŠ” ëŒ€ë¥™ ì„ íƒ
<select name="continent">
    <option value="Asia">Asia</option>
    <option value="Europe">Europe</option>
    <option value="Africa">Africa</option>
    <option value="Oceania">Oceania</option>
    <option value="North America">North America</option>
    <option value="South America">South America</option>
    <input type="submit" value="Search">
</select>

$query = "SELECT country.name as Country, json_unquote(json_extract(doc,'$.geography.Region')) as Region
          FROM country join countryinfo on country.name = json_unquote(json_extract(doc,'$.Name'))
          WHERE json_unquote(json_extract(doc,'$.geography.Continent')) = '{$filtered_id}' limit 5";
```

- ë‚˜ë¼ ì •ë³´ ìˆ˜ì •
```
// í˜„ì‹œì ê³¼ ë§ì§€ ì•ŠëŠ” ì •ë³´ëŠ” ìƒˆë¡œ ì…ë ¥í•œ ë‚´ìš©({$filtered['column']})ìœ¼ë¡œ ìˆ˜ì • í›„ ìˆ˜ì •ëœ ê²°ê³¼ë¥¼ ì¶œë ¥
$query = "
        UPDATE countryinfo
        SET doc = json_set(doc,'$.Name','{$filtered['Country']}'),
                  doc = json_set(doc,'$.GNP','{$filtered['GNP']}'),
                  doc = json_set(doc,'$.government.HeadOfState','{$filtered['Head']}'),
                  doc = json_set(doc,'$.government.GovernmentForm','{$filtered['GovernmentForm']}'),
                  doc = json_set(doc,'$.demographics.Population','{$filtered['Population']}'),
                  doc = json_set(doc,'$.demographics.LifeExpectancy','{$filtered['LifeExpectancy']}')
        WHERE
            json_unquote(json_extract(doc,'$.Name')) = '{$filtered['Country']}'
        ";
```

- í‰ê·  ë¹„êµ
```
// ì „ ì„¸ê³„ í‰ê·  ê¸°ëŒ€ìˆ˜ëª…ê³¼ ì¸êµ¬ ìˆ˜ë¥¼ ì›í•˜ëŠ” ë‚˜ë¼ì™€ ë¹„êµ
$query = "SELECT avg(json_extract(doc,'$.demographics.LifeExpectancy')) as avg_LifeExpectancy,
                 avg(json_extract(doc,'$.demographics.Population')) as avg_Population
          From countryinfo";
$query2 = "SELECT country.Name as Country, json_unquote(json_extract(doc,'$.demographics.LifeExpectancy')) as LifeExpectancy,
                  json_unquote(json_extract(doc,'$.demographics.Population')) as Population
           FROM country join countryinfo on country.name = json_unquote(json_extract(doc,'$.Name'))
           WHERE country.Name = '{$filtered_id}'";
```
ğŸ“¼ ë™ì‘ ì˜ìƒ
<https://drive.google.com/drive/folders/1wIdvNANDJQQeb9sqv27sPT3ghRjR2l0g?usp=sharing>
1. kë¡œ ì‹œì‘í•˜ëŠ” ë‚˜ë¼ë“¤ ì •ë³´ ì¶œë ¥
2. íŠ¹ì • ë‚˜ë¼(south korea)ì— ëŒ€í•œ ì •ë³´ ì¶œë ¥
3. south koreaì˜ head ìˆ˜ì • í›„ ìˆ˜ì • ê²°ê³¼(ê¹€ëŒ€ì¤‘ -> ë¬¸ì¬ì¸) ì¶œë ¥
4. ëŒ€ë¥™ë³„ ë‚˜ë¼ ì¡°íšŒ -> ì•„í”„ë¦¬ì¹´ ëŒ€ë¥™ì˜ ë‚˜ë¼ë“¤ ì¶œë ¥
5. south koreaì™€ ì „ì„¸ê³„ í‰ê·  ê¸°ëŒ€ìˆ˜ëª…, ì¸êµ¬ ìˆ˜ ë¹„êµ
